<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Product ‚Ä¢ HookedByKerrah</title>

  <style>
    :root{
      --bg:#fff3f6; --bg2:#fff8fb; --card:#fff; --text:#2a2a2a;
      --muted:#6f6f6f; --accent:#e6a6b3; --accent-hover:#d98c9a;
      --border:rgba(0,0,0,.08); --shadow:0 12px 30px rgba(0,0,0,.08);
      --radius:18px; --max:980px;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      background:radial-gradient(1200px 600px at 20% 0%,var(--bg2),var(--bg));
      color:var(--text)
    }
    .wrap{max-width:var(--max);margin:0 auto;padding:20px}

    /* Top bar */
    .topbar{
      display:flex;justify-content:space-between;align-items:center;
      padding:14px;background:rgba(255,255,255,.9);
      border-radius:var(--radius);border:1px solid var(--border);box-shadow:var(--shadow)
    }
    a.back{
      font-weight:900;color:var(--text);text-decoration:none;
      padding:8px 12px;border-radius:12px;border:1px solid var(--border);background:#fff
    }

    /* Product card */
    .card{
      margin-top:16px;background:var(--card);
      border-radius:var(--radius);box-shadow:var(--shadow);
      border:1px solid var(--border);overflow:hidden
    }
    .grid{display:grid;grid-template-columns:1fr 1fr}

    /* Image area */
    .imgWrap{
      background:#111;min-height:320px;
      display:flex;align-items:center;justify-content:center;
      cursor:zoom-in
    }
    .imgWrap img{width:100%;height:100%;object-fit:contain;background:#111;display:block}

    /* Info panel */
    .info{padding:16px}
    h1{margin:0 0 6px;font-size:24px}
    .desc{color:var(--muted);margin-bottom:10px}
    .price{font-weight:950;font-size:18px;margin-bottom:6px}
    .hint{font-size:12px;color:var(--muted);margin-bottom:10px}

    label{display:block;font-weight:900;margin:10px 0 6px}
    select,input{width:100%;padding:10px;border-radius:12px;border:1px solid var(--border);font-weight:700}
    .row{display:grid;grid-template-columns:1fr 1fr;gap:10px}

    .btn{
      width:100%;margin-top:12px;padding:12px;border-radius:14px;border:none;
      font-weight:950;cursor:pointer;background:var(--accent);color:#fff
    }
    .btn:hover{background:var(--accent-hover)}
    .btn.black{background:#111}
    .noteBox{margin-top:12px;font-size:13px;color:var(--muted)}
    .checkRow{display:flex;gap:10px;align-items:center;margin-top:10px}
    .checkRow input{width:auto}

    a.igLink{color:var(--accent-hover);font-weight:900;text-decoration:none}
    a.igLink:hover{text-decoration:underline}

    @media(max-width:820px){
      .grid{grid-template-columns:1fr}
      .row{grid-template-columns:1fr}
    }
  </style>
</head>

<body>
  <div class="wrap">
    <!-- =========================
         TOP BAR
    ========================== -->
    <div class="topbar">
      <a class="back" href="index.html">‚Üê Back to Home</a>
      <strong>HookedByKerrah ‚ú®</strong>
    </div>

    <!-- =========================
         PRODUCT CARD
    ========================== -->
    <div class="card">
      <div class="grid">

        <!-- LEFT: big product image -->
        <div class="imgWrap" id="imgWrap">
          <!-- IMAGE (product page big image): set by JS using item.img -->
          <img id="prodImg" alt="">
        </div>

        <!-- RIGHT: content -->
        <div class="info">
          <h1 id="prodName">Product</h1>
          <p class="desc" id="prodDesc"></p>

          <!-- Bullet details (optional per product) -->
          <div id="detailsBox" style="display:none;margin:10px 0 14px;padding:12px;border-radius:14px;border:1px solid rgba(0,0,0,.08);background:rgba(255,255,255,.8);">
            <strong style="display:block;margin-bottom:6px">Product Details</strong>
            <ul id="prodBullets" style="margin:0;padding-left:18px;color:#6f6f6f;font-weight:650;line-height:1.5"></ul>
          </div>

          <!-- Live price -->
          <div class="price" id="prodPrice"></div>
          <div class="hint" id="priceHint"></div>

          <!-- =========================
               CORE OPTIONS (hide per product)
          ========================== -->
          <div class="row">
            <div id="sizeWrap">
              <label for="size">Size</label>
              <select id="size"></select>
            </div>

            <div id="materialWrap">
              <label for="material">Material</label>
              <select id="material"></select>
            </div>
          </div>

          <!-- Color dropdown (used by some products like hats/tote/cardigan) -->
          <div id="colorWrap" style="display:none;margin-top:10px">
            <label for="color">Color</label>
            <select id="color"></select>
          </div>

          <!-- Add-on dropdown (used for Glitter, Length, etc) -->
          <div id="addonWrap" style="display:none;margin-top:10px">
            <label id="addonLabel" for="addon">Add-on</label>
            <select id="addon"></select>
          </div>

          <!-- =========================
               SCRUNCHIES: DESIGN YOUR OWN
               (shows only when id=scrunchies_diy)
          ========================== -->
          <div id="scrunchDIY" style="display:none;margin-top:10px">
            <label for="colorStyle">Color style</label>
            <select id="colorStyle"></select>

            <div class="row" style="margin-top:8px">
              <div>
                <label for="color1" style="margin-top:0">Main color</label>
                <select id="color1"></select>
              </div>

              <div id="color2Wrap">
                <label for="color2" style="margin-top:0">Second color (+$3)</label>
                <select id="color2"></select>
              </div>
            </div>

            <label style="margin-top:10px" for="trim">Trim (optional)</label>
            <select id="trim"></select>
            <div class="hint" style="margin-top:6px">
              Trim adds $0.25 (regular) or $0.50 (glitter).
            </div>
          </div>

          <!-- =========================
               SCRUNCHIES: PREMADE
               (shows only when id=scrunchies)
          ========================== -->
          <div id="scrunchPremade" style="display:none;margin-top:10px">
            <label for="trim2">Trim (optional)</label>
            <select id="trim2"></select>
            <div class="hint" style="margin-top:6px">
              Trim adds $0.25 (regular) or $0.50 (glitter).
            </div>
          </div>

          <!-- =========================
               CROP TOP MEASUREMENTS
               (shows only when id=croptop)
          ========================== -->
          <div id="measurementArea" style="display:none;margin-top:10px">
            <label>Measurements (required)</label>
            <p class="hint">Required. Price adjusts slightly if above baselines.</p>

            <div style="margin-top:6px">
              <label for="mBust">Bust (in inches)</label>
              <input id="mBust" type="number" min="0" placeholder="e.g. 34">
            </div>

            <div style="margin-top:6px">
              <label for="mShoulder">Over-shoulder circumference</label>
              <input id="mShoulder" type="number" min="0" placeholder="e.g. 36">
            </div>

            <div style="margin-top:6px">
              <label for="mLength">Top length (in inches)</label>
              <input id="mLength" type="number" min="0" placeholder="e.g. 10">
            </div>
          </div>

          <!-- =========================
               PILLOW CUSTOM SIZE INPUTS
               (shows only when size is Custom)
          ========================== -->
          <div id="pillowCustomArea" style="display:none;margin-top:10px">
            <label>Custom size (inches)</label>
            <div class="row">
              <div>
                <label for="pW" style="margin-top:0">Width</label>
                <input id="pW" type="number" min="0" placeholder="e.g. 18">
              </div>
              <div>
                <label for="pH" style="margin-top:0">Height</label>
                <input id="pH" type="number" min="0" placeholder="e.g. 18">
              </div>
            </div>
          </div>

          <!-- Pillow add-ons -->
          <div id="pillowAddons" style="display:none;margin-top:10px">
            <label>Extras</label>
            <div class="checkRow">
              <input type="checkbox" id="addFlowers">
              <label for="addFlowers" style="margin:0;font-weight:800">Flowers (qty 4 corners) +$4</label>
            </div>
            <div class="checkRow">
              <input type="checkbox" id="addTassels">
              <label for="addTassels" style="margin:0;font-weight:800">Tassels (qty 4 corners) +$2</label>
            </div>
          </div>

          <!-- =========================
               PAYMENT BUTTONS
          ========================== -->
          <button class="btn" id="paypalBtn">Click here to buy via PayPal</button>
          <button class="btn black" id="appleBtn">Apple Pay (Coming Soon)</button>

          <div class="noteBox" id="finalNote">
            All items are handmade & made to order. All sales final. <br>
            DM me on Instagram:
            <a class="igLink" href="https://instagram.com/HookedByKerrah" target="_blank" rel="noopener">@HookedByKerrah</a>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- =========================
       LIGHTBOX (click image to zoom)
  ========================== -->
  <div id="lightbox" style="display:none;position:fixed;inset:0;background:rgba(0,0,0,.82);align-items:center;justify-content:center;z-index:60;">
    <div style="width:min(1000px,98%);background:#fff;border-radius:16px;overflow:hidden;">
      <div style="padding:10px;text-align:right;">
        <button id="lbClose" style="padding:6px 10px;border-radius:10px;border:1px solid rgba(0,0,0,.08);background:#fff;cursor:pointer">Close ‚úï</button>
      </div>
      <img id="lbImg" src="" style="width:100%;height:auto;display:block;background:#111" alt="">
    </div>
  </div>

<script>
/* =========================================================
   PAYPAL LINKS (placeholders)
   Replace later ‚Äî for now they can stay as PAYPAL_...
========================================================= */
const PAYPAL_LINKS = {
  "santa:kids_regular": "PAYPAL_SANTA_KIDS_REGULAR",
  "santa:kids_glitter": "PAYPAL_SANTA_KIDS_GLITTER",
  "santa:adult_regular": "PAYPAL_SANTA_ADULT_REGULAR",
  "santa:adult_glitter": "PAYPAL_SANTA_ADULT_GLITTER",
  "tote:default": "PAYPAL_TOTE_DEFAULT",

  "cardigan:sm_med_crop": "PAYPAL_CARDIGAN_SM_MED_CROP",
  "cardigan:sm_med_hip": "PAYPAL_CARDIGAN_SM_MED_HIP",
  "cardigan:sm_med_mid": "PAYPAL_CARDIGAN_SM_MED_MID",
  "cardigan:sm_med_duster": "PAYPAL_CARDIGAN_SM_MED_DUSTER",
  "cardigan:med_lg_crop": "PAYPAL_CARDIGAN_MED_LG_CROP",
  "cardigan:med_lg_hip": "PAYPAL_CARDIGAN_MED_LG_HIP",
  "cardigan:med_lg_mid": "PAYPAL_CARDIGAN_MED_LG_MID",
  "cardigan:med_lg_duster": "PAYPAL_CARDIGAN_MED_LG_DUSTER",
  "cardigan:lg_xl_crop": "PAYPAL_CARDIGAN_LG_XL_CROP",
  "cardigan:lg_xl_hip": "PAYPAL_CARDIGAN_LG_XL_HIP",
  "cardigan:lg_xl_mid": "PAYPAL_CARDIGAN_LG_XL_MID",
  "cardigan:lg_xl_duster": "PAYPAL_CARDIGAN_LG_XL_DUSTER",

  "croptop:base": "PAYPAL_CROPTOP_BASE",
  "croptop:custom": "PAYPAL_CROPTOP_CUSTOM",

  "scrunch_diy:single_acrylic": "PAYPAL_SCRUNCH_DIY_SINGLE_ACRYLIC",
  "scrunch_diy:single_cotton": "PAYPAL_SCRUNCH_DIY_SINGLE_COTTON",
  "scrunch_diy:single_plush": "PAYPAL_SCRUNCH_DIY_SINGLE_PLUSH",

  "scrunch_pre:single_acrylic": "PAYPAL_SCRUNCH_PRE_SINGLE_ACRYLIC",
  "scrunch_pre:single_cotton": "PAYPAL_SCRUNCH_PRE_SINGLE_COTTON",
  "scrunch_pre:single_plush": "PAYPAL_SCRUNCH_PRE_SINGLE_PLUSH",
  "scrunch_pre:3_acrylic": "PAYPAL_SCRUNCH_PRE_3_ACRYLIC",
  "scrunch_pre:3_cotton": "PAYPAL_SCRUNCH_PRE_3_COTTON",
  "scrunch_pre:3_plush": "PAYPAL_SCRUNCH_PRE_3_PLUSH",

  "pillow:standard": "PAYPAL_PILLOW_STANDARD",
  "pillow:custom": "PAYPAL_PILLOW_CUSTOM"
};

/* =========================================================
   HELPERS
========================================================= */
function money(n){ return `$${Number(n).toFixed(0)}`; }
function fillSimple(select, arr){ select.innerHTML = (arr||[]).map(a=>`<option>${a}</option>`).join(""); }
function fillValueLabel(select, arr){ select.innerHTML = (arr||[]).map(o=>`<option value="${o.value}">${o.label}</option>`).join(""); }
function uniq(arr){ return [...new Set(arr)]; }

/* =========================================================
   COLOR LISTS
========================================================= */
const COLORS_NO_BLACK = ["Pink","Red","Green","Blue","White","Orange","Yellow","Purple"];
const COLORS_WITH_WHITE_COMBOS = COLORS_NO_BLACK
  .filter(c => c !== "White")
  .map(c => `${c}/White`);

/* =========================================================
   PRODUCTS
   IMPORTANT: keys must match index.html links exactly
========================================================= */
const PRODUCTS = {
  santahats: {
    name:"Santa Hats",
    /* IMAGE (product): Santa hats */
    img:"images/SantaHats.jpeg",
    desc:"Holiday magic, handmade. Choose your size and favorite color combo ‚Äî then add a little sparkle if you want.",
    bullets:[
      "Kids start at $30 ‚Ä¢ Adults start at $35",
      "Choose hat + trim color combo",
      "Optional glitter (+$5)",
      "Handmade to order"
    ],
    showSize:true,
    showMaterial:false,
    sizes:["Kids","Adult"],
    materials:["Standard"],
    colorOptions: uniq([
      "Red Hat/White Trim",
      "Black Hat/Red Trim",
      "White Hat/Red Trim",
      "Pink Hat/White Trim",
      "White Hat/Pink Trim"
    ]),
    addon:{
      label:"Glitter",
      options:[
        {label:"No glitter", value:"none"},
        {label:"Glitter (+$5)", value:"glitter"}
      ]
    },
    pricing: sel => {
      const isAdult = sel.size === "Adult";
      const isGlitter = sel.addon === "glitter";
      let price = isAdult ? 35 : 30;
      if(isGlitter) price += 5;
      const key = (isAdult ? "santa:adult_" : "santa:kids_") + (isGlitter ? "glitter" : "regular");
      return {price, key, hint: isGlitter ? "Glitter adds $5." : ""};
    }
  },

  tote: {
    name:"Tote Bag",
    /* IMAGE (product): Tote */
    img:"images/IMG_4125.jpg",
    desc:"A statement tote with cozy texture and real room for your day ‚Äî pick a colorway that fits your vibe.",
    bullets:[
      "Roomy everyday tote",
      "Choose a colorway",
      "Handmade crochet construction",
      "Fixed price: $45"
    ],
    showSize:false,
    showMaterial:false,
    sizes:["One size"],
    materials:["As pictured"],
    colorOptions: uniq([
      "Blue Multicolor (Pictured)",
      "Pink/White",
      "Pink",
      ...COLORS_NO_BLACK,
      ...COLORS_WITH_WHITE_COMBOS
    ]),
    pricing: () => ({price:45, key:"tote:default", hint:"Fixed price."})
  },

  cardigan: {
    name:"Hexagon Cardigan",
    /* IMAGE (product): Cardigan */
    img:"images/BlueHexagonCardigan.png",
    desc:"Your new favorite layer ‚Äî cozy, bold, and made to order. Choose your size range, length, and color vibe.",
    bullets:[
      "Made to order",
      "Choose size range + length",
      "Color vibe options available",
      "Length affects price"
    ],
    showSize:true,
    showMaterial:false,
    sizes:["S‚ÄìM","M‚ÄìL","L‚ÄìXL"],
    materials:["Acrylic"],
    colorOptions: uniq([
      "Black With Red Trim (Pictured)",
      "Pink/White/Red (Valentines Vibes)",
      "Black/Grey/White",
      ...COLORS_NO_BLACK,
      ...COLORS_WITH_WHITE_COMBOS
    ]),
    addon:{
      label:"Length",
      options:[
        {label:"Cropped Silhouette (waist)", value:"crop"},
        {label:"Hip-Length Hemline (+$15)", value:"hip"},
        {label:"Mid-Thigh Cut (+$30)", value:"mid"},
        {label:"Duster-Length Finish (+$50)", value:"duster"}
      ]
    },
    pricing: sel => {
      const sizeKey = sel.size || "S‚ÄìM";
      let base = 120;
      if(sizeKey==="S‚ÄìM") base = 120;
      if(sizeKey==="M‚ÄìL") base = 135;
      if(sizeKey==="L‚ÄìXL") base = 150;

      const length = sel.addon || "crop";
      let add = 0;
      if(length==="hip") add = 15;
      if(length==="mid") add = 30;
      if(length==="duster") add = 50;

      const price = base + add;
      const sizeSlug = (sizeKey==="S‚ÄìM") ? "sm_med" : (sizeKey==="M‚ÄìL") ? "med_lg" : "lg_xl";
      const key = `cardigan:${sizeSlug}_${length}`;
      return {price, key, hint:"Choose size range and length."};
    }
  },

  croptop: {
    name:"Ribbed Lace Drawstring Crop Top (Custom Fit)",
    /* IMAGE (product): Crop top */
    img:"images/IMG_4188.jpg",
    desc:"Made just for you ‚Äî a custom-fit top with a flattering drawstring finish. Enter your measurements for live pricing.",
    bullets:[
      "Custom fit (measurements required)",
      "Base price $95",
      "Price adjusts if measurements exceed baselines",
      "Handmade to order"
    ],
    showSize:false,
    showMaterial:false,
    sizes:["Custom fit"],
    materials:["As pictured"],
    pricing: sel => {
      let price = 95;
      let hint = "Base $95. Price adjusts if measurements exceed baselines.";

      const m = sel.measurements || {bust:0, shoulder:0, length:0};
      const bustBase = 34, shoulderBase = 36, lengthBase = 10;

      const bustAdd = Math.max(0, (m.bust||0) - bustBase) * 1.0;
      const shoulderAdd = Math.max(0, (m.shoulder||0) - shoulderBase) * 0.5;
      const lengthAdd = Math.max(0, (m.length||0) - lengthBase) * 1.0;

      const add = Math.ceil(bustAdd + shoulderAdd + lengthAdd);
      if(add > 0){
        price += add;
        hint = `Measurements add +$${add} (above baselines).`;
        return {price, key:"croptop:custom", hint};
      }
      return {price, key:"croptop:base", hint};
    }
  },

  /* =========================
     CUSTOM SCRUNCHIE (SINGLE ONLY)
  ========================== */
  scrunchies_diy: {
    name:"Custom Scrunchie (Design Your Own)",
    /* IMAGE (product): Custom scrunchie
       CHANGE THIS to your individual scrunchie image when ready */
    img:"images/IMG_4189.jpg",
    desc:"Build the scrunchie you‚Äôre dreaming of ‚Äî choose your yarn, colors, and finishing trim (price updates live).",
    bullets:[
      "Sold individually",
      "Choose material + 1 or 2 colors",
      "Second color adds +$3",
      "Optional trim (+$0.25 / +$0.50 glitter)"
    ],
    showSize:false,      /* hides size dropdown */
    showMaterial:true,
    sizes:["Single"],
    materials:["Acrylic","Cotton","Plush"],
    pricing: sel => {
      const mat = sel.material || "Acrylic";
      let price = (mat==="Acrylic") ? 10 : 12;
      let key = `scrunch_diy:single_${mat.toLowerCase()}`;
      let hint = "Sold individually";

      // two colors +$3
      if(sel.colorStyle === "two"){
        price += 3;
        hint += " ‚Ä¢ Two colors +$3";
      }

      // trim fee
      const t = (sel.trim || "No trim").toLowerCase();
      let trimFee = 0;
      if(t !== "no trim"){
        trimFee = t.startsWith("glitter") ? 0.50 : 0.25;
      }
      price += trimFee;
      if(trimFee) hint += ` ‚Ä¢ Trim +$${trimFee.toFixed(2)}`;

      return {price, key, hint};
    }
  },

  /* =========================
     PREMADE SCRUNCHIES
  ========================== */
  scrunchies: {
    name:"Premade Scrunchies",
    /* IMAGE (product): Premade scrunchies */
    img:"images/IMG_4189.jpg",
    desc:"Ready-to-ship style ‚Äî grab a single or a bundle. Optional trim available.",
    bullets:[
      "Singles + packs available",
      "Choose material",
      "Optional trim (+$0.25 / +$0.50 glitter)"
    ],
    showSize:true,
    showMaterial:true,
    sizes:["Single","3-Pack","3-Valentine"],
    materials:["Acrylic","Cotton","Plush"],
    pricing: sel => {
      const mat = sel.material || "Acrylic";

      let price = (mat==="Acrylic") ? 10 : 12;
      let key = `scrunch_pre:single_${mat.toLowerCase()}`;
      let hint = "Single scrunchie";

      if(sel.size==="3-Pack"){
        price = (mat==="Acrylic") ? 27 : (mat==="Cotton") ? 32 : 33;
        key = `scrunch_pre:3_${mat.toLowerCase()}`;
        hint = "3-pack pricing";
      } else if(sel.size==="3-Valentine"){
        price = (mat==="Acrylic") ? 30 : (mat==="Cotton") ? 34 : 36;
        key = `scrunch_pre:3_${mat.toLowerCase()}`;
        hint = "Valentine 3-pack special";
      }

      const t = (sel.trim || "No trim").toLowerCase();
      let trimFee = 0;
      if(t !== "no trim"){
        trimFee = t.startsWith("glitter") ? 0.50 : 0.25;
      }
      price += trimFee;
      if(trimFee) hint += ` ‚Ä¢ Trim +$${trimFee.toFixed(2)}`;

      return {price, key, hint};
    }
  },

  pillow: {
    name:"Pillow Covers (Cover Only)",
    /* IMAGE (product): Pillow cover (replace later) */
    img:"images/BlueHexagonCardigan.png",
    desc:"Upgrade your space with cozy texture ‚Äî choose your size and finish with optional flowers or tassels.",
    bullets:[
      "Cover only (insert not included)",
      "Standard sizes + custom sizing option",
      "Plush includes yarn upcharge by size tier",
      "Add flowers (+$4) and tassels (+$2)"
    ],
    showSize:true,
    showMaterial:true,
    sizes:[
      "16x16 (Small throw)",
      "18x18 (Throw)",
      "20x20 (Throw)",
      "22x22 (Large throw)",
      "24x24 (Oversized)",
      "12x20 (Lumbar)",
      "Custom (enter size)"
    ],
    materials:["Acrylic","Cotton","Plush"],
    pricing: sel => {
      const sizeKey = sel.size || "18x18 (Throw)";
      const isCustom = sizeKey.startsWith("Custom");

      const acrylicBase = {
        "16x16 (Small throw)": 35,
        "18x18 (Throw)": 40,
        "20x20 (Throw)": 45,
        "22x22 (Large throw)": 50,
        "24x24 (Oversized)": 55,
        "12x20 (Lumbar)": 38
      };
      const cottonBase = Object.fromEntries(Object.entries(acrylicBase).map(([k,v]) => [k, v+10]));
      const plushUpcharge = {
        "16x16 (Small throw)": 3,
        "18x18 (Throw)": 6,
        "20x20 (Throw)": 9,
        "22x22 (Large throw)": 12,
        "24x24 (Oversized)": 15,
        "12x20 (Lumbar)": 6
      };

      let base = 40;

      if(!isCustom){
        if(sel.material === "Cotton") base = cottonBase[sizeKey] ?? 50;
        else base = acrylicBase[sizeKey] ?? 40;

        if(sel.material === "Plush"){
          base = (acrylicBase[sizeKey] ?? 40) + (plushUpcharge[sizeKey] ?? 6);
        }
      } else {
        const w = Number(sel.pillowW || 0);
        const h = Number(sel.pillowH || 0);
        const area = w * h;

        let acrylic = Math.max(40, Math.ceil(area * 0.14));
        let cotton = acrylic + 10;
        let plush = acrylic + (3 * Math.max(1, Math.ceil(area / 300)));

        base = (sel.material === "Cotton") ? cotton : (sel.material === "Plush") ? plush : acrylic;
      }

      let extras = 0;
      if(sel.flowers) extras += 4;
      if(sel.tassels) extras += 2;

      const price = base + extras;
      const key = isCustom ? "pillow:custom" : "pillow:standard";
      return {price, key, hint:"Cover only. Plush includes yarn upcharge. Extras priced below."};
    }
  }
};

/* =========================================================
   SAFE PRODUCT LOOKUP (prevents Product not found forever)
========================================================= */
const params = new URLSearchParams(window.location.search);
let productId = params.get("id");

// Fallback to first product if missing or invalid
if(!productId || !PRODUCTS[productId]){
  const firstKey = Object.keys(PRODUCTS)[0];
  productId = firstKey;
  window.history.replaceState({}, "", `${window.location.pathname}?id=${productId}`);
}
const item = PRODUCTS[productId];

/* =========================================================
   GET DOM ELEMENTS
========================================================= */
const prodName = document.getElementById("prodName");
const prodDesc = document.getElementById("prodDesc");
const prodImg = document.getElementById("prodImg");
const prodPrice = document.getElementById("prodPrice");
const priceHint = document.getElementById("priceHint");
const detailsBox = document.getElementById("detailsBox");
const prodBullets = document.getElementById("prodBullets");

const sizeWrap = document.getElementById("sizeWrap");
const materialWrap = document.getElementById("materialWrap");
const sizeSel = document.getElementById("size");
const materialSel = document.getElementById("material");

const colorWrap = document.getElementById("colorWrap");
const colorSel = document.getElementById("color");

const addonWrap = document.getElementById("addonWrap");
const addonLabel = document.getElementById("addonLabel");
const addonSel = document.getElementById("addon");

const scrunchDIY = document.getElementById("scrunchDIY");
const colorStyle = document.getElementById("colorStyle");
const color1 = document.getElementById("color1");
const color2Wrap = document.getElementById("color2Wrap");
const color2 = document.getElementById("color2");
const trim = document.getElementById("trim");

const scrunchPremade = document.getElementById("scrunchPremade");
const trim2 = document.getElementById("trim2");

const measurementArea = document.getElementById("measurementArea");
const mBust = document.getElementById("mBust");
const mShoulder = document.getElementById("mShoulder");
const mLength = document.getElementById("mLength");

const pillowCustomArea = document.getElementById("pillowCustomArea");
const pW = document.getElementById("pW");
const pH = document.getElementById("pH");
const pillowAddons = document.getElementById("pillowAddons");
const addFlowers = document.getElementById("addFlowers");
const addTassels = document.getElementById("addTassels");

const paypalBtn = document.getElementById("paypalBtn");
const appleBtn = document.getElementById("appleBtn");

/* =========================================================
   RENDER BASE PRODUCT INFO
========================================================= */
document.title = `${item.name} ‚Ä¢ HookedByKerrah`;
prodName.textContent = item.name;
prodDesc.textContent = item.desc;

/* IMAGE: Big product image is set here */
prodImg.src = item.img;
prodImg.alt = item.name;

/* Bullets */
if(item.bullets && item.bullets.length){
  detailsBox.style.display = "block";
  prodBullets.innerHTML = item.bullets.map(b => `<li>${b}</li>`).join("");
} else {
  detailsBox.style.display = "none";
}

/* Show/hide size/material */
sizeWrap.style.display = (item.showSize === false) ? "none" : "block";
materialWrap.style.display = (item.showMaterial === false) ? "none" : "block";

/* Fill size/material */
fillSimple(sizeSel, item.sizes || ["One size"]);
fillSimple(materialSel, item.materials || ["As pictured"]);

/* Color dropdown (only for products that have colorOptions) */
if(item.colorOptions && item.colorOptions.length){
  colorWrap.style.display = "block";
  fillSimple(colorSel, item.colorOptions);
} else {
  colorWrap.style.display = "none";
}

/* Add-on dropdown (glitter/length/etc) */
if(item.addon){
  addonWrap.style.display = "block";
  addonLabel.textContent = item.addon.label;
  fillValueLabel(addonSel, item.addon.options);
} else {
  addonWrap.style.display = "none";
}

/* =========================================================
   CONDITIONAL UI
========================================================= */
const scrunchColorList = ["Multicolor","Pink","Red","Green","Blue","White","Orange","Yellow","Purple"];
const trimOptions = ["No trim","Pink","Red","Green","Blue","White","Orange","Yellow","Black","Glitter (red)","Glitter (white)","Glitter (silver)","Glitter (pink)"];

/* Scrunchies UI */
if(productId === "scrunchies_diy"){
  scrunchDIY.style.display = "block";
  scrunchPremade.style.display = "none";

  fillSimple(colorStyle, ["Single color (base price)","Two colors (+$3)"]);
  fillSimple(color1, scrunchColorList);
  fillSimple(color2, scrunchColorList);
  fillSimple(trim, trimOptions);

  function syncColorStyle(){
    const isTwo = (colorStyle.selectedIndex === 1);
    color2Wrap.style.display = isTwo ? "block" : "none";
  }
  colorStyle.addEventListener("change", syncColorStyle);
  syncColorStyle();
}
else if(productId === "scrunchies"){
  scrunchDIY.style.display = "none";
  scrunchPremade.style.display = "block";
  fillSimple(trim2, trimOptions);
}
else{
  scrunchDIY.style.display = "none";
  scrunchPremade.style.display = "none";
}

/* Crop top measurements */
measurementArea.style.display = (productId === "croptop") ? "block" : "none";

/* Pillow add-ons */
pillowAddons.style.display = (productId === "pillow") ? "block" : "none";
if(productId !== "pillow") pillowCustomArea.style.display = "none";

/* =========================================================
   UPDATE PRICE LIVE
========================================================= */
function update(){
  const sel = {
    size: (item.showSize === false) ? (item.sizes?.[0] || "One size") : sizeSel.value,
    material: (item.showMaterial === false) ? (item.materials?.[0] || "As pictured") : materialSel.value,
    color: (colorWrap.style.display !== "none") ? colorSel.value : null,
    addon: (addonWrap.style.display !== "none") ? addonSel.value : null,

    // scrunchies info
    colorStyle: (productId==="scrunchies_diy") ? (colorStyle.selectedIndex === 1 ? "two" : "single") : null,
    trim: (productId==="scrunchies_diy") ? trim.value : (productId==="scrunchies") ? trim2.value : "No trim",

    // pillow info
    pillowW: (productId==="pillow") ? Number(pW.value||0) : 0,
    pillowH: (productId==="pillow") ? Number(pH.value||0) : 0,
    flowers: (productId==="pillow") ? !!addFlowers.checked : false,
    tassels: (productId==="pillow") ? !!addTassels.checked : false
  };

  // crop top measurements
  if(productId==="croptop"){
    sel.measurements = {
      bust: Number(mBust.value||0),
      shoulder: Number(mShoulder.value||0),
      length: Number(mLength.value||0)
    };
  }

  // show pillow custom inputs only when size is Custom
  if(productId==="pillow"){
    const isCustom = sel.size.startsWith("Custom");
    pillowCustomArea.style.display = isCustom ? "block" : "none";
  }

  const out = item.pricing(sel);
  prodPrice.textContent = money(out.price);
  priceHint.textContent = out.hint || "";

  paypalBtn.dataset.payKey = out.key;

  // validations
  paypalBtn.dataset.cropOk =
    (productId==="croptop" && sel.measurements.bust>0 && sel.measurements.shoulder>0 && sel.measurements.length>0) ? "true" : "false";

  paypalBtn.dataset.pillowCustomOk =
    (productId==="pillow" && sel.size.startsWith("Custom"))
      ? ((sel.pillowW>0 && sel.pillowH>0) ? "true" : "false")
      : "true";
}

/* Listeners */
sizeSel.addEventListener("change", update);
materialSel.addEventListener("change", update);
if(colorSel) colorSel.addEventListener("change", update);
if(addonSel) addonSel.addEventListener("change", update);

if(productId==="scrunchies_diy"){
  colorStyle.addEventListener("change", update);
  trim.addEventListener("change", update);
}
if(productId==="scrunchies"){
  trim2.addEventListener("change", update);
}
if(productId==="croptop"){
  mBust.addEventListener("input", update);
  mShoulder.addEventListener("input", update);
  mLength.addEventListener("input", update);
}
if(productId==="pillow"){
  pW.addEventListener("input", update);
  pH.addEventListener("input", update);
  addFlowers.addEventListener("change", update);
  addTassels.addEventListener("change", update);
}

update();

/* =========================================================
   LIGHTBOX
========================================================= */
const imgWrap = document.getElementById("imgWrap");
const lightbox = document.getElementById("lightbox");
const lbImg = document.getElementById("lbImg");
const lbClose = document.getElementById("lbClose");

imgWrap.addEventListener("click", ()=> {
  lbImg.src = item.img || "";
  lightbox.style.display = "flex";
});
lbClose.addEventListener("click", ()=> {
  lightbox.style.display = "none";
  lbImg.src = "";
});
lightbox.addEventListener("click", (e)=> {
  if(e.target === lightbox){
    lightbox.style.display = "none";
    lbImg.src = "";
  }
});

/* =========================================================
   PAY BUTTONS
========================================================= */
paypalBtn.addEventListener("click", ()=>{
  if(productId==="croptop" && paypalBtn.dataset.cropOk !== "true"){
    alert("Please enter ALL required measurements (bust, over-shoulder, and top length).");
    return;
  }
  if(paypalBtn.dataset.pillowCustomOk !== "true"){
    alert("Please enter both width and height for your custom pillow size.");
    return;
  }

  const payKey = paypalBtn.dataset.payKey;
  const payLink = PAYPAL_LINKS[payKey];

  // For launch: allow placeholders and just show the key
  if(!payLink || payLink.startsWith("PAYPAL_")){
    alert(
      "Payment link not set yet (totally fine for launch).\n\n" +
      "Selected tier key:\n" + payKey + "\n\n" +
      "Later: replace that key in PAYPAL_LINKS with your real PayPal link."
    );
    return;
  }

  window.open(payLink, "_blank", "noopener");
});

appleBtn.addEventListener("click", ()=> {
  alert("Apple Pay coming soon after your domain is connected üçé");
});
</script>
</body>
</html>
